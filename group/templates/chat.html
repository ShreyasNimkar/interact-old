{% extends 'basemain.html' %}
{% load static %}
{% block title %}Welcome{%endblock%}

{% block css %}
<link rel="stylesheet" href="{%static 'feed.css'%}">
<style>
    .logo {
        max-height: 5vh;
        max-width: 8vh;
        display: flex;
        justify-content: center;
        align-items: center;
        margin-top: 0;
    }

    .logo a {
        max-width: 8vh;
        height: 6vh;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .logo a img {
        max-width: 7vw;
    }

    * {
        margin: 0;
    }

    body {
        background-image: none;
    }

    nav {
        background-color: rgb(36, 36, 36);
        font-family: "Quicksand";
        z-index: 10;
    }

    nav div {
        color: rgb(226, 226, 226);
    }

    nav {
        width: 100vw;
        height: 6vh;
    }

    .grouparea {
        display: flex;
        justify-content: space-around;
        align-items: center;
    }

    .grouplist {
        width: 26vw;
        height: 94vh;
        background-color: rgb(49, 49, 49);
        display: flex;
        flex-direction: column;
        align-items: center;
        overflow-y: scroll;
    }

    .group {
        width: 24vw;
        height: 12vh;
        margin-top: 1vh;
        display: flex;
        align-items: center;
        justify-content: space-evenly;
        border: 1px solid white;
    }
    .icon{
        height: 11vh;
        width: 11vh;
        border-radius: 100%;
        background-color: coral;
    }
    .icon img{
        height: 11vh;
        width: 11vh;
        border-radius: 100%;
        object-fit: cover;
    }
    .grpinfo{
        height: 11vh;
        width: 16vw;
        display: flex;
        flex-direction: column;
        justify-content: center;
        gap: 0.5vh;
        font-family: 'Quicksand';
        color: white;
    }
    .grpname{
        font-size: 30px;
        font-weight: 700;
    }
    .grpmembers{
        font-size: 18px;
    }
    .grouppreface{
        width: 72vw;
        height: 92vh;
        border: 2px solid white;
        border-radius: 5px;
    }
    .groupchat {
        width: 72vw;
        height: 85vh;
        background-color: rgb(29, 29, 29);
        display: flex;
        flex-direction: column;
        overflow-y: scroll;
    }

    .userchat {
        display: flex;
        flex-direction: column;
        align-self: flex-start;
        gap: 1vh;
        max-width: 36vw;
        background-color: rgb(73, 73, 73);
        padding: 1vw;
        border-radius: 30px;
        border: 2px solid white;
        margin: 0.5vw;
        word-wrap: break-word;
    }

    .user {
        display: flex;
        align-items: center;
        gap: 0.4vw;
        font-size: 20px;
        font-family: 'Quicksand';
        font-weight: 700;
        color: white;
    }

    .pic {
        height: 4vh;
        width: 4vh;
        border-radius: 100%;
        background-color: cornflowerblue;
    }

    .pic img {
        height: 4vh;
        width: 4vh;
        border-radius: 100%;
        object-fit: cover;
    }

    .username {}

    .line {
        max-width: 36vw;
        height: 0.2vh;
        background-color: white;
    }

    .chat {
        font-size: 20px;
        font-family: 'Quicksand';
        color: white;
        white-space:normal;
    }
    .selfuser{
        align-self: flex-end;
    }
    .addmessage{
        width: 72vw;
        height: 7vh;    
    }
    .addmessage form{
        display: flex;
        justify-content: space-evenly;
        align-items: center;
    }
    form textarea{
        width: 65.8vw;
        max-width: 65.8vw;
        min-width: 65.8vw;
        height: 5vh;
        max-height: 5vh;
        min-height: 5vh;
        border-radius: 20px;
        background-color: rgb(218, 218, 218);
        font-size: 18px;
        font-family: 'Quicksand';
        padding: 5px;
    }
    form input{
        font-family: 'Quicksand';
        border-radius: 15px;
        width: 10vh;
        height: 6vh;
        font-size: 15px;
        background-color: rgb(218, 218, 218);
        border: 2px solid black;
    }
    .highlight{
        background-color: rgb(175, 175, 175);
    }
</style>
{% endblock %}

{% block main %}

{% load custom_tags %}

<nav>
    <div class="logo">
        <a href="/user/feed/"><img src="{% static 'white with underline.png' %}" alt=""></a>
    </div>
    <div class="nav_items">
        <a href="/user/feed/">
            <div>Feed</div>
        </a>
        <a href="/grp/view/">
            <div>Explore</div>
        </a>
        <a href="/grp/joinchat">
            <div> Groups</div>
        </a>
    </div>
    <a href="/logout">
        <div class="logout">logout</div>
    </a>
</nav>

<div class="grouparea">
    <div class="grouplist">
        {% for user_group in user_groups %}
        {% if group|same:user_group %}
        <a href="/grp/view/{{user_group.slug}}">
            <div class="group highlight">
                <div class="icon">
                    <img src="/media/{{user_group.icon}}" alt="">
                </div>
                <div class="grpinfo">
                    <div class="grpname">
                        {{user_group.name}}
                    </div>
                    <div class="grpmembers">
                        {{user_group.no_of_members}} Members
                    </div>
                </div>
            </div>
            </a>
        {%else%}
        <a href="/grp/joinchat/{{user_group.slug}}">
            <div class="group">
                <div class="icon">
                    <img src="/media/{{user_group.icon}}" alt="">
                </div>
                <div class="grpinfo">
                    <div class="grpname">
                        {{user_group.name}}
                    </div>
                    <div class="grpmembers">
                        {{user_group.no_of_members}} Members
                    </div>
                </div>
            </div>
            </a>
        {%endif%}
        {% endfor %}
    </div>
    <div class="grouppreface">
    <div class="groupchat">

        {% for chat in posts %}

        {% if chat.user|same:request.user %}
        <div class="userchat selfuser">
            <div class="user">
                <div class="pic">
                    <img src="/media/{{chat.user.profile_pic}}" alt="">
                </div>
                <a class="username">
                    You
                </a>
            </div>
            <div class="line"></div>
            <div class="chat">
                {{chat.message}}
            </div>
        </div>
        {% else %}
        <div class="userchat">
            <div class="user">
                <div class="pic">
                    <img src="/media/{{chat.user.profile_pic}}" alt="">
                </div>
                <a class="username" href="/user/view/{{chat.user.username}}">
                    @{{chat.user.username}}
                </a>
            </div>
            <div class="line"></div>
            <div class="chat">
                {{chat.message}}
            </div>
        </div>
        {% endif %}
        {% endfor %}

    </div>
    <div class="addmessage">
        <form action="/grp/joinchat/{{group.slug}}/post" method="post">
            {% csrf_token %}
            <textarea name="message" id="" cols="30" rows="10" value=""></textarea>
            <input type="submit" value="message">
        </form>
    </div>
</div>
</div>

{%endblock%}


<!-- <div class="chatbox">
    {%for post in posts%}

    {% if post.user is request.user %}
    <div class="chat_ofuser">
        {{post.message}} by <a href="/user/view/{{post.user}}">{{post.user}}</a>
    </div>
    {% else %}
    <div class="chat_ofelse">
        {{post.message}} by <a href="/user/view/{{post.user}}">{{post.user}}</a>
        <br>

    </div>
    {%endif%}
    <br>
    {%endfor%}
</div> -->



<form action="/grp/joinchat/{{group.slug}}/post" method="post">
    {% csrf_token %}
    <textarea name="message" id="" cols="30" rows="10" value=""></textarea>
    <input type="submit" value="Send">
</form>